---
key: 20190329
title: 如何设计租户VPC网络-AWS
tags: AWS 云最佳实践 AWS-ANSWERS AWS-HOW-TO VPC 
published: false
---

### 如何设计租户VPC
AWS VPC 提供了丰富的网络虚拟化能力，基于此能力用户可以通过多种选择来设计与实现租户网络。但是，如何使用这些丰富的网络虚拟化能力设计出一个理想的租户网络有一定的难度，特别是很多企业并没有专业的网络人员情况下。因此这篇文章提供了VPC网络设计的最佳实践，包括设计原则、配置规则。 <!--more-->

### 通用最佳实践
网络设计有一些传统的通用原则，在VPC网络内继续生效。如：本地私有网络的子网地址与远程子网地址不要重叠、地址规划时候需要为扩容做预留等。下面是一些VPC网络设计最佳实践：

- 确保VPC网络地址范围（[CIDR](https://uule.iteye.com/blog/2102484)）与企业其他私有网络的地址范围不重合；如果是多Region场景，不同Region之间的网络CIDR建议不要有重合，否则在跨Region VPC互通时候会存在问题
- 不要一次分配完所有地址，要确保为未来预留足够的地址数量
- VPC网络地址范围需要考虑一个Region多AZ，为多个AZ预留地址
- 为有不同网络流量需求的服务器单独划分子网（如典型的 public subnet vs. private subnet）
- VPC 网络地址范围（CIDR）大小需要考虑未来业务增长
- VPC 网络地址符合IANA规范，不能与Internet地址范围重合 (译者增加，原文没有)
```
IP地址由IANA（Internet地址分配机构）管理和分配，任何一个IP地址要能够在Internet上使用就必须由IANA分配，IANA 分配的能够在Internet上正常使用的IP地址称之为公共IP地址；IANA保留了一部份IP地址没有分配给任何机构和个人，这部份IP地址不能在 Internet上使用，此类IP地址就称之为私有IP地址。为什么私有IP地址不能在Internet上使用呢？因为Internet上没有私有IP地 址的路由。私有IP地址范围包括：

A类：10.0.0.0/8

B类：172.16.0.0/12 即172.16.0.1-172.31.255.254共16个B类网络

C类：192.168.0.0/16即192.168.0.1-192.168.255.254共256个C类网络
```

### AWS VPC 实践
当你着手在AWS上设计租户VPC网络，你需要考虑两个点，一个是外部（用户，后端系统，网络路由规则）如何与AWS VPC网络交互，另外一个是当前以及未来的网络规模大小预估。时刻牢记你可以很容易的更改VPC网络设计，从一种配置改为另一种配置，如增加一个独立的Internet子网；同时也需要时刻牢记，你不能更改VPC或子网网络大小。


### Reference
[AWS SINGLE VPC DESIGN](http://d0.awsstatic.com/aws-answers/AWS_Single_VPC_Design.pdf)
[AWS Single VPC Design](https://aws.amazon.com/answers/networking/aws-single-vpc-design/)
[AWS Answers](https://aws.amazon.com/answers/)

